<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>load</title>
    <link href="/static/layui/css/layui.css" rel="stylesheet">
</head>

<body>
    <div style="margin-left:auto; margin-right:auto; max-width: 600px;margin-top: 10rem;">
        <!--登录界面-->
        <h1>登录管理员后台</h1>
        <br />
        <form class="layui-form">
            <div class="demo-login-container">
                <!--user-->
                <div class="layui-form-item">
                    <div class="layui-input-wrap">
                        <div class="layui-input-prefix">
                            <i class="layui-icon layui-icon-username"></i>
                        </div>
                        <input type="text" name="username" id="user" value="" lay-verify="required" placeholder="用户名"
                            lay-reqtext="请填写用户名" autocomplete="off" class="layui-input" lay-affix="clear">
                        <div class="layui-input-affix layui-input-suffix layui-hide"><i
                                class="layui-icon layui-icon-clear"></i></div>
                    </div>
                </div>
                <!--psw-->
                <div class="layui-form-item">
                    <div class="layui-input-wrap">
                        <div class="layui-input-prefix">
                            <i class="layui-icon layui-icon-password"></i>
                        </div>
                        <input type="password" name="password" id="psw" value="" lay-verify="required"
                            placeholder="密   码" lay-reqtext="请填写密码" autocomplete="off" class="layui-input"
                            lay-affix="eye">
                        <div class="layui-input-affix layui-input-suffix"><i
                                class="layui-icon layui-icon-eye-invisible"></i></div>
                    </div>
                </div>

                <br />
                <!--load-->
                <div class="layui-form-item">
                    <button class="layui-btn layui-btn-fluid" lay-submit lay-filter="demo-submit">登录</button>
                </div>

            </div>
        </form>
    </div>
    <!-- HTML Content -->
    <script src="/static/layui/layui.js"></script>
    <script src="/static/js/1.js"></script>
    <script>
        //
        var $ = layui.$;
        var form = layui.form;
        var layer = layui.layer;
        // 提交事件
        form.on('submit(demo-submit)', function (data) {
            var field = data.field; // 获取表单全部字段值

            $.ajax({
                url: "/admin/login",
                type: "POST",
                data: {
                    "username": field["username"],
                    "password": field["password"]
                },
                success: function (data) {
                    console.log(data);
                    var code = data["code"];
                    var msg = data["msg"];
                    if (code == 0) {
                        window.location.href="/add_unit.html"
                    } else {
                        layer.msg(msg);
                    }
                },
                error: function (xhr, status, error) {
                    console.error("Error: " + error);
                    layer.msg("请求失败，请稍后重试。");
                }
            });

            return false; // 阻止默认 form 跳转
        });


    </script>
</body>

</html>